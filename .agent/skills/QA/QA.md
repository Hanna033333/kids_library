## 🚨 Critical: 시간/데이터 의존적 버그 검증 (2026-01-19 RCA 기반)

### 교훈: 홈페이지 책 표시 이슈
**문제**: 1주차에는 정상 작동했으나 2주차에 책이 표시되지 않는 시간 의존적 버그 발생  
**원인**: Offset 계산이 실제 데이터 개수를 초과하여 빈 결과 반환  
**QA 실패 이유**: 특정 시점(1주차)에만 테스트하여 주차 변경 시 문제 발견 못함

### 필수 테스트 항목

#### 1. 시간 의존적 로직 테스트
**대상**: 날짜/시간 기반 계산, 주간/월간 로테이션, 캐시 만료 등

**체크리스트**:
- [ ] **현재 시점 테스트**: 오늘 날짜로 정상 작동 확인
- [ ] **미래 시점 테스트**: 시스템 시간을 1주일, 1개월 후로 변경하여 테스트
- [ ] **과거 시점 테스트**: 시스템 시간을 과거로 변경하여 테스트
- [ ] **경계 시점 테스트**: 연말/연초, 월말/월초, 주말/주초 경계에서 테스트
- [ ] **다양한 주차 테스트**: 1주차, 2주차, 52주차 등 다양한 주차에서 동작 확인

**테스트 방법**:
```bash
# Windows: 시스템 시간 변경 (관리자 권한 필요)
Set-Date -Date "2026-01-26"  # 다음 주
Set-Date -Date "2026-12-31"  # 연말

# 또는 코드에서 시간 주입 가능하도록 리팩토링 요청
```

#### 2. 데이터 경계 조건 테스트
**대상**: Pagination, Offset, Limit, Range 쿼리 등

**체크리스트**:
- [ ] **빈 데이터셋**: 데이터가 0개일 때 UI 확인
- [ ] **최소 데이터**: 데이터가 1개일 때 정상 작동
- [ ] **Offset 초과**: Offset이 총 데이터 개수보다 클 때 처리
- [ ] **실제 데이터 개수 확인**: 각 카테고리/필터별 실제 데이터 개수 파악
- [ ] **동적 Offset 계산**: Offset이 실제 데이터 개수를 고려하는지 확인

**검증 스크립트 예시**:
```typescript
// 각 연령대별 데이터 개수 확인
const ageGroups = ['0-3', '4-7', '8-12', '13+']
for (const age of ageGroups) {
  const count = await getBookCount(age)
  console.log(`${age}: ${count}개`)
  
  // 최대 offset 계산
  const maxWeek = 52
  const maxOffset = (maxWeek * 5) % 100
  
  if (count < maxOffset) {
    console.error(`⚠️ 위험: ${age}는 ${count}개인데 최대 offset은 ${maxOffset}`)
  }
}
```

#### 3. 동적 로직 검증
**대상**: 주간 로테이션, 랜덤 추천, A/B 테스트 등

**체크리스트**:
- [ ] **로테이션 동작**: 시간 변경 시 다른 결과 반환 확인
- [ ] **일관성**: 동일 시점에서는 동일 결과 반환 확인
- [ ] **전환 시점**: 로테이션 전환 시점(주 경계)에서 정상 작동
- [ ] **캐시 무효화**: 시간 변경 시 캐시가 올바르게 갱신되는지 확인

#### 4. 상태 저장/복원 테스트
**대상**: localStorage, sessionStorage, 쿠키 등

**체크리스트**:
- [ ] **저장 확인**: 데이터가 올바르게 저장되는지 확인
- [ ] **불러오기 확인**: 페이지 새로고침 후 저장된 데이터 복원 확인
- [ ] **만료 처리**: 오래된 데이터 처리 로직 확인
- [ ] **저장소 초과**: 저장소 용량 초과 시 처리 확인

---

## 📋 표준 QA 체크리스트

### 기능 테스트
- [ ] 기획서(PRD) 명시된 모든 기능 동작 확인
- [ ] Happy Path (정상 시나리오) 테스트
- [ ] Edge Case (극단적 상황) 테스트
- [ ] Error Case (오류 상황) 테스트

### UI/UX 테스트
- [ ] 모든 화면 요소 정상 표시
- [ ] 반응형 디자인 (모바일/태블릿/데스크톱)
- [ ] 로딩 상태 표시
- [ ] 에러 메시지 표시

### 성능 테스트
- [ ] 페이지 로딩 시간 (3초 이내)
- [ ] API 응답 시간
- [ ] 대용량 데이터 처리

### 보안 테스트
- [ ] 인증/인가 확인
- [ ] XSS, CSRF 방어
- [ ] 민감 정보 노출 확인

### 브라우저 호환성
- [ ] Chrome (최신)
- [ ] Safari (모바일)
- [ ] Edge
- [ ] Firefox

---

## 🔄 회귀 테스트 (Regression Test)

### 주간 회귀 테스트
매주 월요일마다 다음 항목 자동 테스트:
- [ ] 시간 의존적 로직 (다음 주 시뮬레이션)
- [ ] 핵심 사용자 플로우
- [ ] 데이터 무결성

### 배포 전 필수 체크
- [ ] 모든 자동화 테스트 통과
- [ ] 수동 QA 체크리스트 완료
- [ ] 성능 지표 확인
- [ ] 에러 로그 확인

---

## 🚀 배포 후 검증 (Post-Deployment Verification) - 필수

배포 직후 반드시 다음 워크플로우를 실행하여 운영 정책(예: 겨울방학 도서 7권 노출) 준수 여부를 확인해야 합니다.

### 개발(Dev) 환경 배포 후
```bash
/verify_dev
```

### 상용(Prod) 환경 배포 후
```bash
/verify_prod
```

**자동 검증 항목:**
1. **홈페이지 상태**: HTTP 200 OK 응답 확인
2. **콘텐츠 정책**: 모든 추천 섹션(겨울방학, 연령별, 어린이도서연구회)의 도서가 DB에서 7권 이상 확보되어 있는지 확인
3. **데이터 로직**: 랜덤 선택 알고리즘 정상 동작 여부 시뮬레이션

---

## 💡 QA 베스트 프랙티스

1. **"지금 되면 다음 주도 된다"고 가정하지 마라**
   - 시간 의존적 로직은 반드시 미래 시점 테스트

2. **"데이터가 충분하다"고 가정하지 마라**
   - 실제 데이터 개수 확인 후 경계 조건 테스트

3. **"한 번 테스트하면 끝"이라고 생각하지 마라**
   - 주기적 회귀 테스트로 지속적 검증

4. **"개발자가 처리했겠지"라고 믿지 마라**
   - 모든 Edge Case를 직접 확인

5. **버그 리포트는 재현 가능하게**
   - 정확한 시간, 데이터 상태, 재현 단계 명시

---

## 📊 QA 메트릭

### 추적 지표
- **버그 발견율**: QA에서 발견한 버그 / 전체 버그
- **회귀 버그율**: 재발한 버그 / 전체 버그
- **시간 의존 버그**: 시간 변경 시 발견된 버그 수
- **데이터 경계 버그**: 데이터 경계 조건에서 발견된 버그 수

### 목표
- QA 버그 발견율: 90% 이상
- 회귀 버그율: 5% 이하
- Critical 버그: 배포 전 100% 해결

