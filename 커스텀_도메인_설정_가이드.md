# 커스텀 도메인 설정 가이드
`api.checkjari.com` → Render 백엔드 연결하기

---

## 📋 준비물
- [ ] Render 계정 로그인 정보
- [ ] 후이즈(Whois) 계정 로그인 정보
- [ ] Vercel 계정 로그인 정보

---

## 1단계: Render에서 커스텀 도메인 추가

### 1-1. Render 대시보드 접속
1. https://dashboard.render.com 접속
2. 로그인

### 1-2. 백엔드 서비스 선택
1. 좌측 메뉴에서 **Web Services** 클릭
2. `kids-library-7gj8` (또는 백엔드 서비스 이름) 선택

### 1-3. 커스텀 도메인 추가
1. 상단 탭에서 **Settings** 클릭
2. 아래로 스크롤해서 **Custom Domains** 섹션 찾기
3. **Add Custom Domain** 버튼 클릭
4. 입력창에 `api.checkjari.com` 입력
5. **Save** 클릭

### 1-4. CNAME 값 복사
- Render가 제공하는 CNAME 값이 표시됩니다
- 예시: `kids-library-7gj8.onrender.com` 또는 다른 값
- **이 값을 복사해두세요!** (다음 단계에서 사용)

---

## 2단계: 후이즈(Whois)에서 DNS 설정

### 2-1. 후이즈 접속
1. https://www.whois.co.kr 접속
2. 로그인

### 2-2. 도메인 관리 페이지
1. 상단 메뉴 **나의 서비스** → **도메인 관리**
2. `checkjari.com` 찾기
3. **DNS 관리** 또는 **네임서버 관리** 클릭

### 2-3. CNAME 레코드 추가
1. **레코드 추가** 또는 **DNS 레코드 추가** 버튼 클릭
2. 다음 정보 입력:
   - **타입(Type)**: `CNAME`
   - **호스트(Host)**: `api`
   - **값(Value)**: Render에서 복사한 값 (예: `kids-library-7gj8.onrender.com`)
   - **TTL**: `3600` (기본값 사용)
3. **저장** 또는 **추가** 클릭

### 2-4. 적용 대기
- DNS 전파는 보통 **5-10분** 소요
- 최대 48시간까지 걸릴 수 있지만 보통 빠름

---

## 3단계: DNS 전파 확인

### 3-1. 터미널에서 확인 (Windows)
```powershell
nslookup api.checkjari.com
```

### 3-2. 온라인 도구로 확인
- https://dnschecker.org 접속
- `api.checkjari.com` 입력
- CNAME 레코드가 표시되면 성공!

---

## 4단계: Render에서 SSL 인증서 확인

### 4-1. Render 대시보드 재확인
1. Render → 백엔드 서비스 → Settings → Custom Domains
2. `api.checkjari.com` 옆에 **초록색 체크** 또는 **Verified** 표시 확인
3. SSL 인증서가 자동으로 발급됩니다 (Let's Encrypt)

---

## 5단계: Vercel 환경변수 업데이트

### 5-1. Vercel 대시보드 접속
1. https://vercel.com 접속
2. 로그인
3. 프론트엔드 프로젝트 선택 (checkjari.com)

### 5-2. 환경변수 수정
1. 상단 탭에서 **Settings** 클릭
2. 좌측 메뉴에서 **Environment Variables** 클릭
3. `NEXT_PUBLIC_API_URL` 찾기
4. **Edit** 클릭
5. 값을 `https://api.checkjari.com`으로 변경
6. **Save** 클릭

### 5-3. 재배포
1. 상단 탭에서 **Deployments** 클릭
2. 최신 배포 옆 **⋯** (점 3개) 클릭
3. **Redeploy** 선택
4. 배포 완료 대기 (1-2분)

---

## 6단계: 최종 테스트

### 6-1. API 직접 접속
브라우저에서 다음 URL 접속:
```
https://api.checkjari.com
```

**예상 결과:**
```json
{
  "message": "Kids Library API",
  "version": "1.0.0",
  "docs": "/docs"
}
```

### 6-2. API 문서 확인
```
https://api.checkjari.com/docs
```
FastAPI Swagger 문서가 표시되면 성공!

### 6-3. 프론트엔드에서 테스트
1. https://checkjari.com 접속
2. 책 검색 또는 목록 조회
3. 개발자 도구(F12) → Network 탭
4. API 요청이 `api.checkjari.com`으로 가는지 확인

---

## ✅ 완료 체크리스트

- [ ] Render에 `api.checkjari.com` 추가 완료
- [ ] 후이즈 DNS CNAME 레코드 추가 완료
- [ ] DNS 전파 확인 (nslookup 또는 dnschecker)
- [ ] Render SSL 인증서 발급 확인
- [ ] Vercel 환경변수 업데이트 완료
- [ ] Vercel 재배포 완료
- [ ] `https://api.checkjari.com` 접속 테스트 성공
- [ ] 프론트엔드에서 API 호출 정상 작동 확인

---

## 🚨 문제 해결

### DNS가 전파되지 않는 경우
- 최대 48시간 대기
- 후이즈 DNS 설정 재확인
- CNAME 값이 정확한지 확인

### Render에서 SSL 인증서 발급 실패
- DNS 전파가 완료되었는지 확인
- Render 대시보드에서 **Retry** 버튼 클릭

### 프론트엔드에서 API 호출 실패
- Vercel 환경변수가 올바른지 확인
- 재배포 후 캐시 클리어 (Ctrl + Shift + R)
- 브라우저 콘솔에서 에러 메시지 확인

---

## 📝 참고사항

- 커스텀 도메인 설정 후에도 기존 `kids-library-7gj8.onrender.com`은 계속 작동합니다
- 나중에 백엔드를 다른 서비스로 이전할 때는 후이즈 DNS만 변경하면 됩니다
- SSL 인증서는 Render가 자동으로 갱신합니다 (무료)
